/**
 * vue-lang-router v0.1.1
 * (c) 2020 Radek Altof
 * Released under the MIT License.
 */

var LangRouter=function(t,e,a,r){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a;var n={name:"LocalizedLink",props:["to"],methods:{localizedTo:function(){if("string"==typeof this.to)return this.$localizePath(this.to);if("object"==typeof this.to&&"string"==typeof this.to.path){var t=JSON.parse(JSON.stringify(this.to));return t.path=this.$localizePath(t.path),t}return this.to}}};n.render=function(t,e){var a=r.resolveComponent("router-link");return r.openBlock(),r.createBlock(a,r.mergeProps({to:t.localizedTo()},t.$attrs),{default:r.withCtx((function(){return[r.renderSlot(t.$slots,"default")]})),_:1},16,["to"])},n.__file="src/plugin/components/LocalizedLink.vue";var o,i,l,s={name:"LanguageSwitcher",data:function(){return{currentUrl:this.url||this.$router.currentRoute.path}},props:["tag","active-class","url"],methods:{getTag:function(){return this.tag?this.tag:"div"},getLinks:function(){var t=[],e=this.activeClass||"router-active-language",a=this._langRouter.translations;for(var r in a)a.hasOwnProperty(r)&&t.push({activeClass:r==this.$i18n.locale?e:"",langIndex:r,langName:a[r].name||r,url:this.$localizePath(this.currentUrl,r)});return t}},watch:{$route:function(t){this.currentUrl=this.url||t.path}}};s.render=function(t,e){return r.openBlock(),r.createBlock(r.resolveDynamicComponent(t.getTag()),{class:"router-language-switcher"},{default:r.withCtx((function(){return[r.renderSlot(t.$slots,"default",{links:t.getLinks()})]})),_:1})},s.__file="src/plugin/components/LanguageSwitcher.vue";var u=[];function c(t,e){console.error("LangRouter: "+t),void 0!==e&&console.error(e)}var f=function(t){for(var e in i)i.hasOwnProperty(e)&&!l[e]&&(l[e]={});for(var r in l)l.hasOwnProperty(r)&&h(t.routes,r);var n=new a(t);return n.beforeEach(p),n};function g(e){return t.i18n.locale=e,document.querySelector("html").setAttribute("lang",e),localStorage.setItem("VueAppLanguage",e),e}function h(t,e,a){t.forEach((function(t){var r=d(t.path,e);a||(r="/"+e+("/"!=r.charAt(0)?"/":"")+r),t.alias?Array.isArray(t.alias)||(t.alias=[t.alias]):t.alias=[],t.path!=r&&-1==t.alias.indexOf(r)&&t.alias.push(r),t.children&&h(t.children,e,!0)}))}function p(e,a,r){var n=e.path.split("/")[1];if(!i[n]){var l=localStorage.getItem("VueAppLanguage");if(l&&i[l])n=l;else{var s=function(){function t(t){return t.split("-")[0].toLowerCase()}if(navigator.languages&&navigator.languages.length)return t(navigator.languages[0]||"");return t(navigator.language||navigator.browserLanguage||navigator.userLanguage||"")}();n=s&&i[s]?s:o}if(n!=o){var f=d(e.path,n);return f="/"+n+("/"!=f.charAt(0)?"/":"")+f,r(f)}}(function(e){return u.includes(e)?Promise.resolve(g(e)):(i[e]&&"function"==typeof i[e].load||c('Unable to load translations for "'+e+'", "load" function is missing!'),i[e].load().then((function(a){return t.i18n.setLocaleMessage(e,a.default||a),u.push(e),g(e)})).catch((function(t){c('Failed to load "'+e+'" translation.',t)})))})(n).then((function(){return r()}))}function d(t,e,a){var r=t.split("/");if(a&&l[a]){var n=l[a],o={};Object.keys(n).forEach((function(t){o[n[t]]=t}));for(var i=0;i<r.length;i++){var s=r[i];r[i]=o[s]||s}}for(var u=0;u<r.length;u++){var c=r[u];":"!=c.charAt(0)&&(r[u]=l[e][c]||c)}return r.join("/")}function v(e,a){a&&l[a]||(a=t.i18n.locale);var r=!1,n=e.split("/");l[n[1]]&&(r=n[1],n.splice(1,1),e=n.join("/"));var i=this.$router.currentRoute.path.split("/")[1];if(a==o&&!l[i]&&!r)return e;var s=d(e,a,r);return s="/"+a+("/"!=s.charAt(0)?"/":"")+s}return f.install=function(r,u){var g;f.installed?c("Already installed."):(f.installed=!0,u||c("Options missing."),o=u.defaultLanguage,i=u.translations,l=u.localizedURLs,((g=Array.isArray(i))||"object"!=typeof i||null===i)&&c("options.translations should be an object, received "+(g?"array":typeof i)+" instead."),((g=Array.isArray(l))||"object"!=typeof l||null===l)&&c("options.localizedURLs should be an object, received "+(g?"array":typeof l)+" instead."),"string"!=typeof o&&c("options.defaultLanguage should be a string, received "+typeof o+" instead."),r.use(e),r.use(a),t.i18n=new e({locale:o,fallbackLocale:o,messages:{}}),r.prototype._langRouter={translations:i},r.prototype.$localizePath=v,r.component("localized-link",n),r.component("language-switcher",s))},"undefined"!=typeof window&&window.Vue&&window.Vue.use(f),t.default=f,t}({},VueI18n,VueRouter,Vue);
